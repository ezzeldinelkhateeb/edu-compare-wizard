# ูุธุงู Fallback ุงููุชุญูู ุจู ูู ุงููุณุชุฎุฏู
## User-Controlled Fallback System

### ๐ ูุธุฑุฉ ุนุงูุฉ | Overview

ุชู ุชุทููุฑ ุงููุธุงู ููุนุชูุฏ ุจุดูู ุฃุณุงุณู ุนูู **LandingAI** ููุง ูุณุชุฎุฏู **Tesseract OCR** ุฅูุง ุจุนุฏ ููุงููุฉ ุตุฑูุญุฉ ูู ุงููุณุชุฎุฏูุ ูุฐูู ูุถูุงู ุฃุนูู ุฏูุฉ ููููุฉ ูู ุงุณุชุฎุฑุงุฌ ุงููุตูุต.

### ๐ฏ ุงูููุณูุฉ ุงูุฌุฏูุฏุฉ | New Philosophy

#### โ ุงูุฃููููุงุช:
1. **LandingAI ุฃููุงู**: ุงูุงุนุชูุงุฏ ุงููุงูู ุนูู LandingAI
2. **ูุญุงููุงุช ูุชุนุฏุฏุฉ**: 7 ูุญุงููุงุช ูุน ุงุณุชุฑุงุชูุฌูุงุช ูุฎุชููุฉ
3. **ุชุตุบูุฑ ุชุฏุฑูุฌู**: ุชุฌุฑุจุฉ ุฃุญุฌุงู ุตูุฑ ูุฎุชููุฉ
4. **ููุงููุฉ ุงููุณุชุฎุฏู**: ูุง Tesseract ุจุฏูู ุฅุฐู ุตุฑูุญ

#### โ ูุง ุชู ุฅุฒุงูุชู:
- ุงูุงุณุชุฎุฏุงู ุงูุชููุงุฆู ูู Tesseract
- ุงูุงูุชูุงู ุงููุจุงุดุฑ ููู fallback
- ูุฑุงุฑุงุช ุชููุงุฆูุฉ ุจุฏูู ุนูู ุงููุณุชุฎุฏู

### ๐ง ุขููุฉ ุงูุนูู ุงูุฌุฏูุฏุฉ | New Workflow

#### 1. ูุฑุญูุฉ LandingAI ุงููุญุณูุฉ
```python
# ุงุณุชุฑุงุชูุฌูุฉ ูุชุฏุฑุฌุฉ
1. ูุญุงููุฉ ูุน ุงูุตูุฑุฉ ุงูุฃุตููุฉ (1024px) - 7 ูุญุงููุงุช
2. ูุญุงููุฉ ูุน ุตูุฑุฉ ุฃุตุบุฑ (512px) - 5 ูุญุงููุงุช  
3. ูุญุงููุฉ ูุน ุตูุฑุฉ ุตุบูุฑุฉ ุฌุฏุงู (256px) - 3 ูุญุงููุงุช
```

#### 2. ูู ุญุงูุฉ ุงููุดู
```json
{
  "success": false,
  "error_message": "ูุดู ูู ุงุณุชุฎุฑุงุฌ ุงููุต ุจุงุณุชุฎุฏุงู LandingAI",
  "fallback_options": {
    "tesseract_available": true,
    "fallback_endpoint": "/api/v1/compare/fallback-ocr/{session_id}",
    "message": "ูููู ุงููุญุงููุฉ ูุน OCR ุงูุชูููุฏู (ุฃูู ุฏูุฉ) ุจุนุฏ ููุงููุชู",
    "warning": "โ๏ธ OCR ุงูุชูููุฏู ุฃูู ุฏูุฉ ูู LandingAI"
  }
}
```

#### 3. ููุงููุฉ ุงููุณุชุฎุฏู
- ุนุฑุถ ุฑุณุงูุฉ ุชุญุฐูุฑูุฉ ูุงุถุญุฉ
- ุดุฑุญ ุฃู Tesseract ุฃูู ุฏูุฉ
- ุทูุจ ููุงููุฉ ุตุฑูุญุฉ
- ุชูููุฐ fallback ููุท ุจุนุฏ ุงูููุงููุฉ

### ๐๏ธ API Endpoints ุงูุฌุฏูุฏุฉ | New API Endpoints

#### 1. ุงูุชุญูู ูู ุญุงูุฉ ุงูุฌูุณุฉ
```http
GET /api/v1/compare/session-status/{session_id}
```

**ุงูุงุณุชุฌุงุจุฉ:**
```json
{
  "session_id": "uuid",
  "status": "completed|partial_failure|failed",
  "extraction_failed": true,
  "fallback_used": false,
  "fallback_available": true,
  "fallback_endpoint": "/api/v1/compare/fallback-ocr/{session_id}",
  "message": "ูููู ุงููุญุงููุฉ ูุน OCR ุงูุชูููุฏู",
  "warning": "โ๏ธ OCR ุงูุชูููุฏู ุฃูู ุฏูุฉ ูู LandingAI"
}
```

#### 2. ุงุณุชุฎุฏุงู Fallback OCR
```http
POST /api/v1/compare/fallback-ocr/{session_id}
```

**ุงูุงุณุชุฌุงุจุฉ:**
```json
{
  "message": "ุชู ุงุณุชุฎุฑุงุฌ ุงููุต ุจุงุณุชุฎุฏุงู Tesseract OCR ูุจุฏูู",
  "session_id": "uuid",
  "old_image_result": { /* ูุชุงุฆุฌ ุงูุตูุฑุฉ ุงููุฏููุฉ */ },
  "new_image_result": { /* ูุชุงุฆุฌ ุงูุตูุฑุฉ ุงูุฌุฏูุฏุฉ */ },
  "warning": "โ๏ธ ุชู ุงุณุชุฎุฏุงู OCR ุงูุชูููุฏู - ูุฏ ุชููู ุงูุฏูุฉ ุฃูู ูู LandingAI",
  "success": true,
  "extraction_method": "Tesseract_Fallback"
}
```

### ๐ป ุชุทุจูู ูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ | Frontend Implementation

#### ูุซุงู ุนูู ุงูุชุทุจูู:
```javascript
// 1. ุฅุฌุฑุงุก ุงูููุงุฑูุฉ ุงููุงููุฉ
const response = await fetch(`/api/v1/compare/full-comparison/${sessionId}`, {
  method: 'POST'
});

const result = await response.json();

// 2. ุงูุชุญูู ูู ุงูุญุงุฌุฉ ูู fallback
if (result.fallback_options) {
  // ุนุฑุถ ุฑุณุงูุฉ ูููุณุชุฎุฏู
  const userConfirmed = confirm(`
    ูุดู ูู ุงุณุชุฎุฑุงุฌ ุงููุต ุจุงุณุชุฎุฏุงู LandingAI.
    
    ${result.fallback_options.message}
    ${result.fallback_options.warning}
    
    ูู ุชุฑูุฏ ุงููุชุงุจุนุฉุ
  `);
  
  if (userConfirmed) {
    // 3. ุงุณุชุฎุฏุงู fallback ุจุนุฏ ุงูููุงููุฉ
    const fallbackResponse = await fetch(result.fallback_options.fallback_endpoint, {
      method: 'POST'
    });
    
    const fallbackResult = await fallbackResponse.json();
    console.log('Fallback result:', fallbackResult);
  }
}
```

### ๐ ููุงุฑูุฉ ุงูุฏูุฉ | Accuracy Comparison

| ุงูุฎุฏูุฉ | ุงูุฏูุฉ | ุงูุณุฑุนุฉ | ุงูุงุณุชุฎุฏุงู |
|---------|-------|---------|-----------|
| **LandingAI** | 95-99% | ูุชูุณุทุฉ | ุฃููููุฉ ูุตูู |
| **Tesseract** | 70-85% | ุณุฑูุนุฉ | ุจุนุฏ ููุงููุฉ ุงููุณุชุฎุฏู ููุท |

### ๐ ุงูุชุญุณููุงุช ุงููุทุจูุฉ | Applied Improvements

#### 1. ุชุญุณูู ุขููุฉ ุฅุนุงุฏุฉ ุงููุญุงููุฉ
```python
# ุฅุนุฏุงุฏุงุช ูุญุณูุฉ
max_retries = 7          # ุจุฏูุงู ูู 5
base_timeout = 120       # ุจุฏูุงู ูู 180  
backoff_factor = 1.8     # ุจุฏูุงู ูู 2.0
```

#### 2. ุงุณุชุฑุงุชูุฌูุฉ ุชุตุบูุฑ ุงูุตูุฑ
```python
# ุชุฏุฑุฌ ุฐูู ูุฃุญุฌุงู ุงูุตูุฑ
1024px โ 512px โ 256px
ูุน ูุญุงููุงุช ูุชุนุฏุฏุฉ ููู ุญุฌู
```

#### 3. ูุนุงูุฌุฉ ุฃุฎุทุงุก ูุญุณูุฉ
```python
# ุชุตููู ุฏููู ููุฃุฎุทุงุก
- ุฃุฎุทุงุก ุงูุดุจูุฉ (ุฅุนุงุฏุฉ ูุญุงููุฉ ุณุฑูุนุฉ)
- ุฃุฎุทุงุก rate limiting (ุงูุชุธุงุฑ ุฃุทูู)
- ุฃุฎุทุงุก ุงูุฎุงุฏู (ุชุตุบูุฑ ุงูุตูุฑุฉ)
```

### ๐ ุงุฎุชุจุงุฑ ุงููุธุงู | System Testing

```bash
# ุชุดุบูู ุงุฎุชุจุงุฑ ุงููุธุงู ุงูุฌุฏูุฏ
cd backend
python test_no_auto_tesseract.py
```

**ูุง ูุฎุชุจุฑู:**
- โ ุนุฏู ุงุณุชุฎุฏุงู Tesseract ุชููุงุฆูุงู
- โ ุนุฑุถ fallback options ุนูุฏ ุงููุดู
- โ ุนูู endpoints ุงูุฌุฏูุฏุฉ
- โ ุฑุณุงุฆู ุงูุชุญุฐูุฑ ูุงูููุงููุฉ

### ๐ ุณููุงุฑูููุงุช ุงูุงุณุชุฎุฏุงู | Use Cases

#### ุณููุงุฑูู 1: ูุฌุงุญ LandingAI
```
1. ุฑูุน ุงูุตูุฑ
2. ุงุณุชุฎุฑุงุฌ ูุงุฌุญ ุจู LandingAI
3. ุนุฑุถ ุงููุชุงุฆุฌ ูุจุงุดุฑุฉ
โ ูุง ุญุงุฌุฉ ูุฃู ุชุฏุฎู
```

#### ุณููุงุฑูู 2: ูุดู LandingAI
```
1. ุฑูุน ุงูุตูุฑ
2. ูุดู LandingAI ุจุนุฏ ุฌููุน ุงููุญุงููุงุช
3. ุนุฑุถ ุฑุณุงูุฉ ูููุณุชุฎุฏู ูุน ุฎูุงุฑุงุช fallback
4. ุงูุชุธุงุฑ ููุงููุฉ ุงููุณุชุฎุฏู
5. ุชูููุฐ Tesseract ุจุนุฏ ุงูููุงููุฉ
โ๏ธ ูุน ุชุญุฐูุฑ ูุงุถุญ ุญูู ุงูุฏูุฉ
```

### ๐๏ธ ุฅุนุฏุงุฏุงุช ุงูุชุญูู | Control Settings

#### ูุชุบูุฑุงุช ุงูุจูุฆุฉ:
```env
# ุชุนุทูู fallback ุชูุงูุงู (ุงุฎุชูุงุฑู)
DISABLE_TESSERACT_FALLBACK=false

# ุชุฎุตูุต ุฑุณุงุฆู ุงูุชุญุฐูุฑ
TESSERACT_WARNING_MESSAGE="OCR ุงูุชูููุฏู ุฃูู ุฏูุฉ"

# ุชุฎุตูุต ุนุฏุฏ ุงููุญุงููุงุช
LANDINGAI_MAX_RETRIES=7
LANDINGAI_RETRY_STRATEGY=progressive
```

### ๐ ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู | User Experience

#### ุฑุณุงุฆู ูุงุถุญุฉ:
- โ "ุฌุงุฑู ุงูุงุณุชุฎุฑุงุฌ ุจุงุณุชุฎุฏุงู LandingAI..."
- โ๏ธ "ูุดู LandingAIุ ูู ุชุฑูุฏ ุชุฌุฑุจุฉ OCR ุฃูู ุฏูุฉุ"
- ๐ "ุฌุงุฑู ุงูุงุณุชุฎุฑุงุฌ ุจุงุณุชุฎุฏุงู OCR ุงูุชูููุฏู..."
- โ "ุชู ุงูุงุณุชุฎุฑุงุฌ ุจูุฌุงุญ (ุฏูุฉ ุฃูู ูู ุงููุชููุน)"

#### ุดูุงููุฉ ูุงููุฉ:
- ุนุฑุถ ุทุฑููุฉ ุงูุงุณุชุฎุฑุงุฌ ุงููุณุชุฎุฏูุฉ
- ุชุญุฐูุฑุงุช ูุงุถุญุฉ ุญูู ูุณุชูู ุงูุฏูุฉ
- ุฅุญุตุงุฆูุงุช ููุงุฑูุฉ ุจูู ุงูุทุฑู

### ๐ ุถูุงูุงุช ุงูุฌูุฏุฉ | Quality Assurance

#### 1. ูุง ุงุณุชุฎุฏุงู ุชููุงุฆู ูู Tesseract
- โ ุชู ุฅุฒุงูุฉ ุฌููุน ุงูุงุณุชุฏุนุงุกุงุช ุงูุชููุงุฆูุฉ
- โ ูุชุทูุจ ููุงููุฉ ุตุฑูุญุฉ ุฏุงุฆูุงู
- โ ุฑุณุงุฆู ุชุญุฐูุฑูุฉ ูุงุถุญุฉ

#### 2. ุฃููููุฉ LandingAI
- โ 7 ูุญุงููุงุช ูุน ุงุณุชุฑุงุชูุฌูุงุช ูุฎุชููุฉ
- โ ุชุตุบูุฑ ุชุฏุฑูุฌู ููุตูุฑ
- โ ูุนุงูุฌุฉ ุฃุฎุทุงุก ูุญุณูุฉ

#### 3. ุดูุงููุฉ ูุงููุฉ
- โ ุฅุธูุงุฑ ุทุฑููุฉ ุงูุงุณุชุฎุฑุงุฌ ุงููุณุชุฎุฏูุฉ
- โ ุชูููู ุฏูุฉ ูุงุถุญ
- โ ุฎูุงุฑุงุช ูุงุถุญุฉ ูููุณุชุฎุฏู

---

**ุชู ุงูุชุญุฏูุซ:** 2025-07-05  
**ุงูุฅุตุฏุงุฑ:** 3.0 - User-Controlled Fallback  
**ุงูุญุงูุฉ:** โ ุฌุงูุฒ ููุฅูุชุงุฌ

### ๐ ุงูุฎูุงุตุฉ

ุงููุธุงู ุงูุขู:
- ๐ฏ **ูุนุชูุฏ ุนูู LandingAI ุจุดูู ุฃุณุงุณู**
- ๐ก๏ธ **ูุง ูุณุชุฎุฏู Tesseract ุชููุงุฆูุงู ุฃุจุฏุงู**
- ๐ค **ูุทูุจ ููุงููุฉ ุงููุณุชุฎุฏู ุตุฑุงุญุฉ**
- โ๏ธ **ูุญุฐุฑ ูู ุงูุฎูุงุถ ุงูุฏูุฉ**
- ๐ **ูููุฑ ุดูุงููุฉ ูุงููุฉ ูู ุงููุชุงุฆุฌ** 